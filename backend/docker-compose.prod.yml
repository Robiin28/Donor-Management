services:
  web:
    build: .
    container_name: donor_ci4_web
    ports:
      - "8080:80"
    depends_on:
      - db
    environment:
      CI_ENVIRONMENT: production
      # CI4 DB settings (make sure your app reads env vars)
      database.default.DBDriver: Postgre
      database.default.hostname: db
      database.default.port: 5432
      database.default.database: donor_db
      database.default.username: donor_user
      database.default.password: donor_pass

  db:
    image: postgres:16
    container_name: donor_ci4_db
    restart: unless-stopped
    environment:
      POSTGRES_DB: donor_db
      POSTGRES_USER: donor_user
      POSTGRES_PASSWORD: donor_pass
    volumes:
      - donor_db_data:/var/lib/postgresql/data

volumes:
  donor_db_data:
